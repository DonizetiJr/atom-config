"use babel";

describe('The GCC provider for AtomLinter', function () {
  var main = require('../lib/main');
  var utility = require('../lib/utility.js');
  var settings = require("../lib/config").settings;

  beforeEach(function () {
    waitsForPromise(function () {
      main.messages = {};
      atom.config.set('linter-gcc.execPath', '/usr/bin/g++');
      atom.config.set('linter-gcc.gccDefaultCFlags', '-c -Wall -o /dev/null');
      atom.config.set('linter-gcc.gccDefaultCppFlags', '-c -Wall -std=c++11 -o /dev/null');
      atom.config.set('linter-gcc.gccErrorLimit', 15);
      atom.config.set('linter-gcc.gccIncludePaths', ' ');
      atom.config.set('linter-gcc.gccSuppressWarnings', true);
      atom.config.set('linter-gcc.gccLintOnTheFly', false);
      atom.config.set('linter-gcc.gccDebug', false);
      atom.config.set('linter-gcc.gccErrorString', 'error');
      atom.config.set('linter-gcc.gccWarningString', 'warning');
      atom.config.set('linter-gcc.gccNoteString', 'note');
      atom.packages.activatePackage('language-c');
      return atom.packages.activatePackage('linter-gcc');
    });
  });

  it('finds one error in error.cpp', function () {
    waitsForPromise(function () {
      filename = __dirname + '/files/error.cpp';
      return atom.workspace.open(filename).then(function (editor) {
        return main.lint(editor, editor.getPath(), editor.getPath()).then(function () {
          var length = utility.flattenHash(main.messages).length;
          expect(length).toEqual(1);
        });
      });
    });
  });

  it('finds no errors in comment.cpp', function () {
    waitsForPromise(function () {
      filename = __dirname + '/files/comment.cpp';
      return atom.workspace.open(filename).then(function (editor) {
        return main.lint(editor, editor.getPath(), editor.getPath()).then(function () {
          var length = utility.flattenHash(main.messages).length;
          expect(length).toEqual(0);
        });
      });
    });
  });

  it('finds one error in error.c', function () {
    waitsForPromise(function () {
      filename = __dirname + '/files/error.c';
      return atom.workspace.open(filename).then(function (editor) {
        return main.lint(editor, editor.getPath(), editor.getPath()).then(function () {
          var length = utility.flattenHash(main.messages).length;
          expect(length).toEqual(1);
        });
      });
    });
  });

  it('finds no errors in comment.c', function () {
    waitsForPromise(function () {
      filename = __dirname + '/files/comment.c';
      return atom.workspace.open(filename).then(function (editor) {
        return main.lint(editor, editor.getPath(), editor.getPath()).then(function () {
          var length = utility.flattenHash(main.messages).length;
          expect(length).toEqual(0);
        });
      });
    });
  });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2p1bmlvci8uYXRvbS9wYWNrYWdlcy9saW50ZXItZ2NjL3NwZWMvbGludGVyLWdjYy1zcGVjLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLFdBQVcsQ0FBQzs7QUFFWixRQUFRLENBQUMsaUNBQWlDLEVBQUUsWUFBTTtBQUNoRCxNQUFNLElBQUksR0FBRyxPQUFPLENBQUMsYUFBYSxDQUFDLENBQUE7QUFDbkMsTUFBTSxPQUFPLEdBQUcsT0FBTyxDQUFDLG1CQUFtQixDQUFDLENBQUE7QUFDNUMsTUFBSSxRQUFRLEdBQUcsT0FBTyxDQUFDLGVBQWUsQ0FBQyxDQUFDLFFBQVEsQ0FBQTs7QUFFaEQsWUFBVSxDQUFDLFlBQU07QUFDZixtQkFBZSxDQUFDLFlBQU07QUFDcEIsVUFBSSxDQUFDLFFBQVEsR0FBRyxFQUFFLENBQUM7QUFDbkIsVUFBSSxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMscUJBQXFCLEVBQUUsY0FBYyxDQUFDLENBQUE7QUFDdEQsVUFBSSxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsNkJBQTZCLEVBQUUsdUJBQXVCLENBQUMsQ0FBQTtBQUN2RSxVQUFJLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQywrQkFBK0IsRUFBRSxrQ0FBa0MsQ0FBQyxDQUFBO0FBQ3BGLFVBQUksQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLDBCQUEwQixFQUFFLEVBQUUsQ0FBQyxDQUFBO0FBQy9DLFVBQUksQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLDRCQUE0QixFQUFFLEdBQUcsQ0FBQyxDQUFBO0FBQ2xELFVBQUksQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLGdDQUFnQyxFQUFFLElBQUksQ0FBQyxDQUFBO0FBQ3ZELFVBQUksQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLDRCQUE0QixFQUFFLEtBQUssQ0FBQyxDQUFBO0FBQ3BELFVBQUksQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLHFCQUFxQixFQUFFLEtBQUssQ0FBQyxDQUFBO0FB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LG1CQUFlLENBQUMsWUFBTTtBQUNwQixjQUFRLEdBQUcsU0FBUyxHQUFHLGtCQUFrQixDQUFBO0FBQ3pDLGFBQU8sSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUMsSUFBSSxDQUFDLFVBQUEsTUFBTSxFQUFJO0FBQ2xELGVBQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsTUFBTSxDQUFDLE9BQU8sRUFBRSxFQUFFLE1BQU0sQ0FBQyxPQUFPLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxZQUFXO0FBQzNFLGNBQUksTUFBTSxHQUFHLE9BQU8sQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDLE1BQU0sQ0FBQTtBQUN0RCxnQkFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQztTQUMzQixDQUFDLENBQUE7T0FDSCxDQUFDLENBQUE7S0FDSCxDQUFDLENBQUE7R0FDSCxDQUFDLENBQUE7Q0FDSCxDQUFDLENBQUEiLCJmaWxlIjoiL2hvbWUvanVuaW9yLy5hdG9tL3BhY2thZ2VzL2xpbnRlci1nY2Mvc3BlYy9saW50ZXItZ2NjLXNwZWMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBiYWJlbFwiO1xuXG5kZXNjcmliZSgnVGhlIEdDQyBwcm92aWRlciBmb3IgQXRvbUxpbnRlcicsICgpID0+IHtcbiAgY29uc3QgbWFpbiA9IHJlcXVpcmUoJy4uL2xpYi9tYWluJylcbiAgY29uc3QgdXRpbGl0eSA9IHJlcXVpcmUoJy4uL2xpYi91dGlsaXR5LmpzJylcbiAgdmFyIHNldHRpbmdzID0gcmVxdWlyZShcIi4uL2xpYi9jb25maWdcIikuc2V0dGluZ3NcblxuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICB3YWl0c0ZvclByb21pc2UoKCkgPT4ge1xuICAgICAgbWFpbi5tZXNzYWdlcyA9IHt9O1xuICAgICAgYXRvbS5jb25maWcuc2V0KCdsaW50ZXItZ2NjLmV4ZWNQYXRoJywgJy91c3IvYmluL2crKycpXG4gICAgICBhdG9tLmNvbmZpZy5zZXQoJ2xpbnRlci1nY2MuZ2NjRGVmYXVsdENGbGFncycsICctYyAtV2FsbCAtbyAvZGV2L251bGwnKVxuICAgICAgYXRvbS5jb25maWcuc2V0KCdsaW50ZXItZ2NjLmdjY0RlZmF1bHRDcHBGbGFncycsICctYyAtV2FsbCAtc3RkPWMrKzExIC1vIC9kZXYvbnVsbCcpXG4gICAgICBhdG9tLmNvbmZpZy5zZXQoJ2xpbnRlci1nY2MuZ2NjRXJyb3JMaW1pdCcsIDE1KVxuICAgICAgYXRvbS5jb25maWcuc2V0KCdsaW50ZXItZ2NjLmdjY0luY2x1ZGVQYXRocycsICcgJylcbiAgICAgIGF0b20uY29uZmlnLnNldCgnbGludGVyLWdjYy5nY2NTdXBwcmVzc1dhcm5pbmdzJywgdHJ1ZSlcbiAgICAgIGF0b20uY29uZmlnLnNldCgnbGludGVyLWdjYy5nY2NMaW50T25UaGVGbHknLCBmYWxzZSlcbiAgICAgIGF0b20uY29uZmlnLnNldCgnbGludGVyLWdjYy5nY2NEZWJ1ZycsIGZhbHNlKVxuICAgICAgYXRvbS5jb25maWcuc2V0KCdsaW50ZXItZ2NjLmdjY0Vycm9yU3RyaW5nJywgJ2Vycm9yJylcbiAgICAgIGF0b20uY29uZmlnLnNldCgnbGludGVyLWdjYy5nY2NXYXJuaW5nU3RyaW5nJywgJ3dhcm5pbmcnKVxuICAgICAgYXRvbS5jb25maWcuc2V0KCdsaW50ZXItZ2NjLmdjY05vdGVTdHJpbmcnLCAnbm90ZScpXG4gICAgICBhdG9tLnBhY2thZ2VzLmFjdGl2YXRlUGFja2FnZSgnbGFuZ3VhZ2UtYycpXG4gICAgICByZXR1cm4gYXRvbS5wYWNrYWdlcy5hY3RpdmF0ZVBhY2thZ2UoJ2xpbnRlci1nY2MnKVxuICAgIH0pXG4gIH0pXG5cbiAgaXQoJ2ZpbmRzIG9uZSBlcnJvciBpbiBlcnJvci5jcHAnLCAoKSA9PiB7XG4gICAgd2FpdHNGb3JQcm9taXNlKCgpID0+IHtcbiAgICAgIGZpbGVuYW1lID0gX19kaXJuYW1lICsgJy9maWxlcy9lcnJvci5jcHAnXG4gICAgICByZXR1cm4gYXRvbS53b3Jrc3BhY2Uub3BlbihmaWxlbmFtZSkudGhlbihlZGl0b3IgPT4ge1xuICAgICAgICByZXR1cm4gbWFpbi5saW50KGVkaXRvciwgZWRpdG9yLmdldFBhdGgoKSwgZWRpdG9yLmdldFBhdGgoKSkudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICB2YXIgbGVuZ3RoID0gdXRpbGl0eS5mbGF0dGVuSGFzaChtYWluLm1lc3NhZ2VzKS5sZW5ndGhcbiAgICAgICAgICBleHBlY3QobGVuZ3RoKS50b0VxdWFsKDEpO1xuICAgICAgICB9KVxuICAgICAgfSlcbiAgICB9KVxuICB9KVxuXG4gIGl0KCdmaW5kcyBubyBlcnJvcnMgaW4gY29tbWVudC5jcHAnLCAoKSA9PiB7XG4gICAgd2FpdHNGb3JQcm9taXNlKCgpID0+IHtcbiAgICAgIGZpbGVuYW1lID0gX19kaXJuYW1lICsgJy9maWxlcy9jb21tZW50LmNwcCdcbiAgICAgIHJldHVybiBhdG9tLndvcmtzcGFjZS5vcGVuKGZpbGVuYW1lKS50aGVuKGVkaXRvciA9PiB7XG4gICAgICAgIHJldHVybiBtYWluLmxpbnQoZWRpdG9yLCBlZGl0b3IuZ2V0UGF0aCgpLCBlZGl0b3IuZ2V0UGF0aCgpKS50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHZhciBsZW5ndGggPSB1dGlsaXR5LmZsYXR0ZW5IYXNoKG1haW4ubWVzc2FnZXMpLmxlbmd0aFxuICAgICAgICAgIGV4cGVjdChsZW5ndGgpLnRvRXF1YWwoMCk7XG4gICAgICAgIH0pXG4gICAgICB9KVxuICAgIH0pXG4gIH0pXG5cbiAgaXQoJ2ZpbmRzIG9uZSBlcnJvciBpbiBlcnJvci5jJywgKCkgPT4ge1xuICAgIHdhaXRzRm9yUHJvbWlzZSgoKSA9PiB7XG4gICAgICBmaWxlbmFtZSA9IF9fZGlybmFtZSArICcvZmlsZXMvZXJyb3IuYydcbiAgICAgIHJldHVybiBhdG9tLndvcmtzcGFjZS5vcGVuKGZpbGVuYW1lKS50aGVuKGVkaXRvciA9PiB7XG4gICAgICAgIHJldHVybiBtYWluLmxpbnQoZWRpdG9yLCBlZGl0b3IuZ2V0UGF0aCgpLCBlZGl0b3IuZ2V0UGF0aCgpKS50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHZhciBsZW5ndGggPSB1dGlsaXR5LmZsYXR0ZW5IYXNoKG1haW4ubWVzc2FnZXMpLmxlbmd0aFxuICAgICAgICAgIGV4cGVjdChsZW5ndGgpLnRvRXF1YWwoMSk7XG4gICAgICAgIH0pXG4gICAgICB9KVxuICAgIH0pXG4gIH0pXG5cbiAgaXQoJ2ZpbmRzIG5vIGVycm9ycyBpbiBjb21tZW50LmMnLCAoKSA9PiB7XG4gICAgd2FpdHNGb3JQcm9taXNlKCgpID0+IHtcbiAgICAgIGZpbGVuYW1lID0gX19kaXJuYW1lICsgJy9maWxlcy9jb21tZW50LmMnXG4gICAgICByZXR1cm4gYXRvbS53b3Jrc3BhY2Uub3BlbihmaWxlbmFtZSkudGhlbihlZGl0b3IgPT4ge1xuICAgICAgICByZXR1cm4gbWFpbi5saW50KGVkaXRvciwgZWRpdG9yLmdldFBhdGgoKSwgZWRpdG9yLmdldFBhdGgoKSkudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICB2YXIgbGVuZ3RoID0gdXRpbGl0eS5mbGF0dGVuSGFzaChtYWluLm1lc3NhZ2VzKS5sZW5ndGhcbiAgICAgICAgICBleHBlY3QobGVuZ3RoKS50b0VxdWFsKDApO1xuICAgICAgICB9KVxuICAgICAgfSlcbiAgICB9KVxuICB9KVxufSlcbiJdfQ==
//# sourceURL=/home/junior/.atom/packages/linter-gcc/spec/linter-gcc-spec.js
